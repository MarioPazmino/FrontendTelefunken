<div class="modal" *ngIf="isVisible">
  <div class="modal-content">
    <span class="close" (click)="closeModal()">&times;</span>
    <h2>{{ isRegister ? 'Crear Cuenta' : 'Iniciar Sesión' }}</h2>

    <form (ngSubmit)="onSubmit()">
      <!-- Mostrar mensajes de error generales -->
      <p *ngIf="errorMessage" class="error-message">{{ errorMessage }}</p>

      <!-- Formulario de Inicio de Sesión -->
      <div *ngIf="!isRegister">
        <label for="username">Usuario</label>
        <input type="text" id="username" [(ngModel)]="username" name="username" required />
        <div *ngIf="!username && isSubmitted" class="error-message">El campo usuario es obligatorio.</div>

        <label for="password">Contraseña</label>
        <input type="password" id="password" [(ngModel)]="password" name="password" required />
        <div *ngIf="!password && isSubmitted" class="error-message">El campo contraseña es obligatorio.</div>

        <p>
          <a href="javascript:void(0)" (click)="toggleRegister()">¿No tienes una cuenta? Regístrate</a>
        </p>
      </div>

      <!-- Formulario de Registro -->
      <div *ngIf="isRegister">
        <label for="name">Nombre</label>
        <input type="text" id="name" [(ngModel)]="name" name="name" required />
        <div *ngIf="!name && isSubmitted" class="error-message">El campo nombre es obligatorio.</div>

        <label for="email">Correo Electrónico</label>
        <input type="email" id="email" [(ngModel)]="email" name="email" required (blur)="checkEmailExistence()" />
        <div *ngIf="!email && isSubmitted" class="error-message">El campo correo es obligatorio.</div>
        <div *ngIf="emailExists && isSubmitted" class="error-message">El correo ya está registrado.</div>

        <label for="username">Usuario</label>
        <input type="text" id="username" [(ngModel)]="username" name="username" required />
        <div *ngIf="!username && isSubmitted" class="error-message">El campo usuario es obligatorio.</div>

        <label for="password">Contraseña</label>
        <input type="password" id="password" [(ngModel)]="password" name="password" required />
        <div *ngIf="!password && isSubmitted" class="error-message">El campo contraseña es obligatorio.</div>

        <p>
          <a href="javascript:void(0)" (click)="toggleRegister()">¿Ya tienes una cuenta? Inicia sesión</a>
        </p>
      </div>

      <button type="submit" [disabled]="!isFormValid()">
        {{ isRegister ? 'Registrar' : 'Entrar' }}
      </button>
    </form>
  </div>
</div>
